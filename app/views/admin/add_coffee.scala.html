@(coffeeForm: play.data.Form[models.Coffee], request: Http.Request)

@main("Add Coffee") {
<h2>Add New Coffee</h2>

<form action="@routes.AdminController.create()" method="post" enctype="multipart/form-data">
    @helper.CSRF.formField(request.asScala())  <!-- ✅ Convert request to RequestHeader -->

    <label for="name">Name:</label>
    <input type="text" name="name" required><br>

    <label for="price">Price (KES):</label>
    <input type="text" name="price" required><br>

    <label for="size">Size:</label>
    <input type="text" name="size" required><br>


    <!-- Drag & Drop Image Upload -->
    <label>Upload Image:</label>
    <div id="drop-area">
        <p>Drag & Drop an image here or <span id="file-select">click to upload</span></p>
        <input type="file" name="image" id="image-input" accept="image/*" hidden>
        <img id="preview" src="" alt="Image Preview">
    </div>

    <button type="submit">Add Coffee</button>
</form>

<!-- ✅ JavaScript for Drag & Drop -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const dropArea = document.getElementById("drop-area");
        const fileInput = document.getElementById("image-input");
        const fileSelect = document.getElementById("file-select");
        const preview = document.getElementById("preview");

        // Click event to trigger file input
        fileSelect.addEventListener("click", () => fileInput.click());

        // Handle file input change
        fileInput.addEventListener("change", (event) => handleFiles(event.target.files));

        // Drag & Drop Events
        dropArea.addEventListener("dragover", (event) => {
            event.preventDefault();
            dropArea.classList.add("dragover");
        });

        dropArea.addEventListener("dragleave", () => {
            dropArea.classList.remove("dragover");
        });

        dropArea.addEventListener("drop", (event) => {
            event.preventDefault();
            dropArea.classList.remove("dragover");
            handleFiles(event.dataTransfer.files);
        });

        function handleFiles(files) {
            if (files.length > 0) {
                const file = files[0];
                const reader = new FileReader();
                reader.onload = () => {
                    preview.src = reader.result;
                    preview.style.display = "block";
                };
                reader.readAsDataURL(file);
                fileInput.files = files;
            }
        }
    });
</script>

<!-- ✅ Improved CSS -->
<style>
    #drop-area {
        border: 2px dashed #ccc;
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        cursor: pointer;
        background-color: #f9f9f9;
        margin-bottom: 10px;
        width: 100%;
        max-width: 400px;
    }
    #drop-area p {
        margin: 0;
        font-weight: bold;
    }
    #drop-area.dragover {
        border-color: #007bff;
        background-color: #e0e0e0;
    }
    #preview {
        display: none;
        max-width: 100%;
        height: auto;
        margin-top: 10px;
        border-radius: 5px;
        box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);
    }
</style>
}
